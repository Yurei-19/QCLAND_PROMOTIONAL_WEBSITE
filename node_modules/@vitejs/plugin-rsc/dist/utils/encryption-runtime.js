import { r as once } from "../dist-yW9-EeG1.js";
import { a as fromBase64, i as encryptBuffer, n as concatArrayStream, r as decryptBuffer, t as arrayToStream } from "../encryption-utils-DdqSKS_O.js";
import "../rsc-Bhp6O2qz.js";
import { createFromReadableStream, renderToReadableStream } from "../react/rsc.js";
import encryptionKeySource from "virtual:vite-rsc/encryption-key";

//#region src/utils/encryption-runtime.ts
async function encryptActionBoundArgs(originalValue) {
	return encryptBuffer(await concatArrayStream(renderToReadableStream(originalValue)), await getEncryptionKey());
}
async function decryptActionBoundArgs(encrypted) {
	const serializedBuffer = await decryptBuffer(await encrypted, await getEncryptionKey());
	return createFromReadableStream(arrayToStream(new Uint8Array(serializedBuffer)));
}
const getEncryptionKey = /* @__PURE__ */ once(async () => {
	const resolved = await encryptionKeySource();
	return await crypto.subtle.importKey("raw", fromBase64(resolved), { name: "AES-GCM" }, true, ["encrypt", "decrypt"]);
});

//#endregion
export { decryptActionBoundArgs, encryptActionBoundArgs };